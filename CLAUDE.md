# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a LINE-clone chat application built with React, TypeScript, Vite, and AWS Amplify. The application features real-time messaging, authentication, and chat room management.

## Commands

### Development
- `npm run dev` - Start the Vite development server
- `npm run build` - Build the production application
- `npm run lint` - Run ESLint for code quality checks
- `npm run preview` - Preview the production build locally

### AWS Amplify Backend
- `npx ampx pipeline-deploy --branch $AWS_BRANCH --app-id $AWS_APP_ID` - Deploy Amplify backend resources

## Architecture

### Tech Stack
- **Frontend**: React 18, TypeScript, Vite
- **Styling**: Tailwind CSS
- **Backend**: AWS Amplify Gen 2
- **Authentication**: AWS Cognito (via Amplify Auth)
- **Database**: AWS AppSync with DynamoDB (via Amplify Data)
- **UI Components**: AWS Amplify UI React, Lucide React icons
- **Server**: AWS Lambda as a main for accessing DynamoDB

### Project Structure
- `/src/components/` - React components organized by feature
  - `Auth/` - Authentication components (LoginForm, SignUpForm, AuthWrapper)
  - `Chat/` - Chat application components (ChatApp, ChatRoom, MessageList, etc.)
- `/amplify/` - AWS Amplify backend configuration
  - `auth/resource.ts` - Authentication configuration with email login and nickname attribute
  - `data/resource.ts` - Data schema defining User, ChatRoom, Message, and ChatRoomMember models
  - `backend.ts` - Backend definition combining auth and data resources
- `/src/lib/amplify.ts` - Amplify client configuration
- `/src/types/` - TypeScript type definitions

### Key Data Models
1. **User** - Stores user profile with email, nickname, avatar, and status
2. **ChatRoom** - Defines chat rooms with type (private/group), metadata
3. **Message** - Chat messages with content, type, sender info
4. **ChatRoomMember** - Manages chat room membership and roles

### Authentication Flow
- Email-based authentication with required nickname attribute
- Uses AWS Amplify Authenticator component for UI
- Authorization rules ensure users can only access their own data and authenticated content

### Build Configuration
- TypeScript configured with strict mode and bundler module resolution
- ESLint setup with React hooks and refresh plugins
- Vite optimized for React development with hot module replacement
- Node.js version 20 required for builds (specified in amplify.yml)

## Important Notes
- The application uses AWS Amplify Gen 2 with TypeScript-based backend configuration
- All data models have built-in authorization rules for security
- The frontend expects `amplify_outputs.json` for configuration (generated by Amplify CLI)
- Tailwind CSS is configured for styling
- The project uses Vite's ES module system

# Load Test
- AWS Lambda for scaling server
- Playwright as an End-to-end test from login to sending message
- Use EC2 for helping the test with high concurrency users
- ECR for storing Docker image
- ECS for container orchestration service to run the container